project_id = "wdpxmwsxhckazwxufttk"

# Cron job for automatic life regeneration every minute
[[edge_runtime.cron]]
schedule = "* * * * *"
function = "regenerate-lives-background"

# Cron job for daily activity aggregation every day at 2 AM
[[edge_runtime.cron]]
schedule = "0 2 * * *"
function = "aggregate-daily-activity"

# Cron job for country-specific daily winners processing (runs every 5 minutes to catch all timezones)
[[edge_runtime.cron]]
schedule = "*/5 * * * *"
function = "process-daily-winners"

# CRITICAL OPTIMIZATION: Leaderboard cache refresh every 1 minute
[[edge_runtime.cron]]
schedule = "* * * * *"
function = "refresh-leaderboard-cache"

# PHASE 1 OPTIMIZATION: Daily rankings materialized view refresh every 5 minutes
[[edge_runtime.cron]]
schedule = "*/5 * * * *"
function = "refresh-daily-rankings-mv"

# PHASE 2 OPTIMIZATION: Game sessions cleanup every hour
[[edge_runtime.cron]]
schedule = "0 * * * *"
function = "cleanup-game-sessions"

# PHASE 2 OPTIMIZATION: Ledger archival monthly (1st of month at 3 AM)
[[edge_runtime.cron]]
schedule = "0 3 1 * *"
function = "archive-ledgers"

# Core Game Functions
[functions.start-game-session]
verify_jwt = true

[functions.complete-game]
verify_jwt = true

[functions.credit-gameplay-reward]
verify_jwt = true

[functions.get-game-questions]
verify_jwt = true

# Auth Functions
[functions.register-with-username-pin]
verify_jwt = false

[functions.login-with-username-pin]
verify_jwt = false

[functions.forgot-pin]
verify_jwt = false

[functions.update-pin]
verify_jwt = true

[functions.update-password]
verify_jwt = true

[functions.submit-dob]
verify_jwt = true

# Daily Gift & Winners Functions
[functions.get-daily-gift-status]
verify_jwt = true

[functions.dismiss-daily-gift]
verify_jwt = true

[functions.get-daily-winners-status]
verify_jwt = true

[functions.process-daily-winners]
verify_jwt = false

[functions.claim-daily-rank-reward]
verify_jwt = true

[functions.dismiss-daily-rank-reward]
verify_jwt = true

[functions.get-pending-rank-reward]
verify_jwt = true

[functions.backfill-daily-winners]
verify_jwt = true

# Wallet & Profile Functions
[functions.get-wallet]
verify_jwt = true

[functions.get-user-game-profile]
verify_jwt = true

[functions.get-dashboard-data]
verify_jwt = true

[functions.update-user-game-settings]
verify_jwt = true

# Booster Functions (Gold-only purchases)
[functions.purchase-booster]
verify_jwt = true

[functions.activate-speed-token]
verify_jwt = true

# Social Functions (Friends, DM, etc.)
[functions.get-friends]
verify_jwt = true

[functions.get-friend-requests]
verify_jwt = true

[functions.send-friend-request]
verify_jwt = true

[functions.accept-friend-request]
verify_jwt = true

[functions.decline-friend-request]
verify_jwt = true

[functions.cancel-friend-request]
verify_jwt = true

[functions.block-user]
verify_jwt = true

[functions.send-dm]
verify_jwt = true

[functions.get-thread-messages]
verify_jwt = true

[functions.get-threads]
verify_jwt = true

[functions.get-threads-optimized]
verify_jwt = true

[functions.upsert-thread]
verify_jwt = true

[functions.upload-chat-image]
verify_jwt = true

[functions.search-users]
verify_jwt = true

[functions.unified-search]
verify_jwt = true

# Leaderboard & Rankings Functions
[functions.get-daily-leaderboard-by-country]
verify_jwt = true

[functions.refresh-leaderboard-cache]
verify_jwt = false

[functions.refresh-daily-rankings-mv]
verify_jwt = false

# Question & Content Functions
[functions.get-topic-popularity]
verify_jwt = false

[functions.get-translations]
verify_jwt = false

[functions.populate-question-pools-en]
verify_jwt = false

[functions.regenerate-question-pools]
verify_jwt = false

# Tutorial Functions
[functions.get-tutorial-progress]
verify_jwt = true

[functions.mark-tutorial-completed]
verify_jwt = true

# Admin Functions
[functions.grant-admin-role]
verify_jwt = true

[functions.admin-activity]
verify_jwt = true

[functions.admin-dashboard-data]
verify_jwt = true

[functions.admin-game-profiles]
verify_jwt = true

[functions.admin-game-profiles-paginated]
verify_jwt = true

[functions.admin-game-profile-detail]
verify_jwt = true

[functions.admin-monetization-analytics]
verify_jwt = true

[functions.admin-retention-analytics]
verify_jwt = true

[functions.admin-engagement-analytics]
verify_jwt = true

[functions.admin-engagement-analytics-optimized]
verify_jwt = true

[functions.admin-journey-analytics]
verify_jwt = true

[functions.admin-performance-analytics]
verify_jwt = true

[functions.admin-player-behaviors]
verify_jwt = true

[functions.admin-topic-popularity]
verify_jwt = true

[functions.admin-age-statistics]
verify_jwt = true

[functions.admin-booster-types]
verify_jwt = true

[functions.admin-booster-purchases]
verify_jwt = true

[functions.admin-ad-interests-summary]
verify_jwt = true

[functions.admin-ad-interests-all-topics]
verify_jwt = true

[functions.admin-ad-interests-users]
verify_jwt = true

[functions.admin-ad-interests-recalculate]
verify_jwt = true

[functions.admin-manual-credit]
verify_jwt = true

[functions.admin-send-report-notification]
verify_jwt = true

[functions.admin-all-data]
verify_jwt = true

# Background Jobs & Maintenance
[functions.regenerate-lives-background]
verify_jwt = false

[functions.aggregate-daily-activity]
verify_jwt = false

[functions.cleanup-game-sessions]
verify_jwt = false

[functions.archive-ledgers]
verify_jwt = false

[functions.refresh-admin-cache]
verify_jwt = false

# Activity & Logging
[functions.log-activity-ping]
verify_jwt = true

# Creator Functions
[functions.create-creator-subscription]
verify_jwt = true

[functions.submit-creator-video]
verify_jwt = true

[functions.get-creator-videos]
verify_jwt = true

[functions.reactivate-creator-video]
verify_jwt = true

[functions.check-creator-subscription]
verify_jwt = true

[functions.creator-webhook]
verify_jwt = false

# Video Ad Functions
[functions.get-ad-video]
verify_jwt = true

[functions.log-video-impression]
verify_jwt = true

[functions.claim-video-reward]
verify_jwt = true
